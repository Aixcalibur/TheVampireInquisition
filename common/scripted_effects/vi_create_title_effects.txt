vi_create_vassal_princedom_effect = {

	save_scope_as = founder

	$VI_LIEGE$ = {
		save_scope_as = vi_liege
	}

	$VI_COUNTY$ = {
		save_scope_as = vi_title_county
	}

	# vi_create_noble_family_effect = yes

	# domicile ?= {
	# 	move_domicile = scope:vi_title_county
	# }

	create_dynamic_title = {
		tier = duchy
		name = VI_NEW_CREATED_PRINCEDOM_NAME
	}
	create_title_and_vassal_change = {
		type = created
		save_scope_as = change
		add_claim_on_loss = no
	}
	scope:new_title = {
		change_title_holder = {
			holder = scope:founder
			change = scope:change
		}
		set_capital_county = scope:vi_title_county
		set_coa = scope:vi_title_county
		set_landless_title = yes
		set_definitive_form = yes
		
	}

	change_liege = {
		liege = scope:vi_liege
		change = scope:change
	}
	
	resolve_title_and_vassal_change = scope:change

	change_government = vi_vampire_government

	# hidden_effect = {
	# 	scope:new_title = {
	# 		# set_de_jure_liege_title = scope:vi_liege.primary_title
	# 		set_coa = scope:vi_title_county
	# 		set_capital_county = scope:vi_title_county
	# 	}
	# }
}

vi_create_noble_family_effect = {
	debug_log = create_noble_family_title

	save_scope_as = new_noble_family_holder
	# hidden_effect = { # NF can only be held by house heads
	# 	house ?= {
	# 		if = {
	# 			limit = { house_head != scope:new_noble_family_holder }
	# 			set_house_head = scope:new_noble_family_holder
	# 		}
	# 	}
	# }

	found_cadet_house_decision_effect = {
		CHARACTER = scope:new_noble_family_holder
		PRESTIGE = 0
	}

	give_noble_family_title = {
		name = noble_family_name
		article = DEFAULT_TITLE_NAME_ARTICLE
		save_scope_as = new_title
	}

	scope:new_title = {
		holder = {
			save_scope_as = noble_family_head
		}
		set_coa = scope:noble_family_head.house
	}
	custom_description = {
		text = create_noble_family_tt
	}

	#Notifications
	# top_liege ?= {
	# 	every_vassal = {
	# 		limit = {
	# 			is_ai = no
	# 			NOT = { this = scope:new_noble_family_holder }
	# 		}
	# 		trigger_event = {
	# 			id = ep3_emperor_yearly.2410
	# 			days = 1
	# 		}
	# 	}
	# }

	debug_log_scopes = yes
}
