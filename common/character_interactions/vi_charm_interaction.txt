#Localization is in Lifestyles
vi_charm_interaction = {
	icon = icon_scheme_seduce
	category = interaction_category_friendly
	common_interaction = yes
	interface_priority = 60
	desc = vi_charm_interaction_desc

	ai_targets = {
		ai_recipients = scripted_relations
	}
	ai_targets = {
		ai_recipients = liege
	}
	ai_targets = {
		ai_recipients = neighboring_rulers
		ai_recipients = peer_vassals
		max = 10
	}
	ai_targets = {
		ai_recipients = vassals
		max = 10
	}
	ai_target_quick_trigger = {
		adult = yes
	}
	ai_frequency = 120

	is_shown = {
		NOT = {
			scope:recipient = scope:actor
		}
		scope:actor = {
			has_perk = vi_charm_perk
		}
	}

	is_highlighted = {
		# scope:recipient = {
		# 	OR = {
		# 		house ?= {
		# 			OR = {
		# 				is_dominant_family = yes
		# 				is_powerful_family = yes
		# 			}
		# 		}
		# 	}
		# }
	}

	highlighted_reason = HIGHLIGHTED_FAMILY_RATING

	is_valid_showing_failures_only = {
		scope:actor = {
			has_perk = vi_charm_perk
		}
		scope:recipient = { is_busy_in_events_localised = yes }
	}

	on_accept = {
		scope:actor = {
			add_character_modifier = {
				modifier = vi_vampire_strain_modifier
				years = 3
			}
			stress_impact = {
				base = miniscule_stress_impact_gain
				just = medium_stress_impact_gain
				lustful = miniscule_stress_impact_loss
				seducer = miniscule_stress_impact_loss
			}
		}
		scope:recipient = {
			# Verify that they could become friend
			if = {
				limit = {
					NAND = {
						has_relation_friend = scope:actor
						has_relation_lover = scope:actor
						has_relation_soulmate = scope:actor
						has_relation_best_friend = scope:actor
					}
				}
				gifting_leads_towards_friendship_effect = yes
			}
			
			send_interface_message = {
				type = send_interface_message_bad
				title = vi_charm_interaction
				desc = vi_charm_interaction_message_desc
				left_icon = scope:actor # optional, character, artifact, or title
				random_list = {
					40 = {
						modifier = { add = scope:actor.diplomacy }
						modifier = { subtract = scope:recipient.intrigue }
						add_opinion = {
							target = scope:actor
							modifier = charmed_opinion
							opinion = {
								value = scope:actor.diplomacy
								multiply = 2
							}
						}
						add_opinion = {
							target = scope:actor
							modifier = suspicion_opinion
							opinion = {
								value = scope:recipient.intrigue
								multiply = -0.5
							}
						}
					}
					40 = {
						add_opinion = {
							target = scope:actor
							modifier = charmed_opinion
							opinion = {
								value = scope:actor.diplomacy
								multiply = 1.5
							}
						}
						add_opinion = {
							target = scope:actor
							modifier = suspicion_opinion
							opinion = {
								value = scope:recipient.intrigue
								multiply = -1
							}
						}
					}
					40 = {
						add_opinion = {
							target = scope:actor
							modifier = suspicion_opinion
							opinion = {
								value = scope:recipient.intrigue
								multiply = -2
							}
						}
						modifier = { subtract = scope:actor.diplomacy }
						modifier = { add = scope:recipient.intrigue }
					}
				}
			}
		}
	}
	
	auto_accept = yes
	
	ai_potential = {
		is_available_at_peace_ai_adult = yes
		# ai_greed < medium_positive_ai_value
		# short_term_gold >= gift_interaction_cutoff
		# ai_has_conqueror_personality = no
		# ai_should_focus_on_building_in_their_capital = no
	}
	
	auto_accept = {
		custom_description = {
			text = auto_accept_interaction_ai	
			object = scope:recipient
			scope:recipient = {
				is_ai = yes
			}
		}
	}
	
	ai_min_reply_days = 1
	ai_max_reply_days = 1
	
	ai_will_do = {
		base = 100
		
		modifier = { # Do not send double-gifts
			factor = 0
			scope:recipient = {
				has_opinion_modifier = {
					target = scope:actor
					modifier = gift_opinion
				}
			}
		}
		modifier = { # Do not send double-gifts
			factor = 0
			scope:recipient = {
				has_opinion_modifier = {
					target = scope:actor
					modifier = charmed_opinion
				}
			}
		}
		
		modifier = {
			factor = 0
			scope:actor.ai_honor >= 75
		}

		modifier = {
			factor = 0
			scope:actor.stress_level >= 2
		}

		modifier = {
			factor = 0.5
			scope:actor.stress_level >= 1
		}

		modifier = {
			factor = 0
			scope:recipient.intrigue > scope:actor.diplomacy
		}
	}
}
